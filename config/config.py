# ===================================================================
# 脑电数据分析配置文件
# 功能: 集中管理所有脚本共用的配置参数，包括数据路径、处理参数、绘图设置等
# ===================================================================

# ===================================================================
# 1. 全局设置 (Global Settings)
# ===================================================================

# 采样率相关设置
SAMPLING_RATE = 20000  # 原始采样率 (Hz)
RESAMPLE_FREQ = 500    # 降采样频率 (Hz)

# 数据切片设置
EPOCH_T_MIN = -0.5     # 切片时，事件前的开始时间 (秒)
EPOCH_T_MAX = 1.5      # 切片时，事件后的结束时间 (秒)

# 处理控制设置
OVERWRITE_EXISTING = True  # 是否覆盖已存在的文件
VERBOSE = True             # 是否显示进度信息

# ===================================================================
# 2. 目录设置 (Directory Settings)
# ===================================================================

# 原始数据根目录
RAW_DATA_DIR = 'd:\\yangkeyin\\datasets\\251010清华数据分析\\acute'

# 处理后的数据输出目录
PROCESSED_DATA_DIR = './data/fif_data'

# 绘图输出目录
PLOTS_DIR = './data/plots'

# ===================================================================
# 3. 被试与文件命名设置 (Subject & File Naming)
# ===================================================================

# 被试映射: 将文件夹名称映射到标准化的被试ID
SUBJECT_MAPPING = {
    '20250612': 'mouse1',
    '20250701': 'mouse2',
    '20250702': 'mouse3'
}

# 文件命名规则
RHD_FILE_EXTENSION = '.rhd'  # 原始数据文件后缀
FIF_FILE_SUFFIX = '_raw.fif'  # 输出FIF文件后缀
EVENTS_FILE_SUFFIX = '_events.tsv'  # 输出事件文件后缀
CHANNEL_PREFIX = 'C-'  # 通道名称前缀

# ===================================================================
# 4. 数据处理设置 (Data Processing Settings)
# ===================================================================

# 滤波设置
NOTCH_FREQS = [50, 100, 150]  # 陷波滤波频率 (Hz)
BANDPASS_L_FREQ = 0.5        # 带通滤波低频截止 (Hz)
BANDPASS_H_FREQ = 200        # 带通滤波高频截止 (Hz)

# MNE通道设置
DEFAULT_CHANNEL_TYPE = 'eeg'  # 默认通道类型

# ===================================================================
# 5. 事件相关设置 (Event Settings)
# ===================================================================

# 事件获取方式配置
EVENTS_CONFIG = {
    'visual': {        
        'type': 'extract_from_rhd',  # 从RHD文件中提取事件
        'digital_channel_index': 1   # 用于提取事件的数字通道索引
    },
    'beard_slow': {
        'type': 'defined_in_config', # 显式声明这是在config里定义的
        'mouse1': [60.0, 180.0, 300.0, 420.0, 540.0],  # 慢刺激触发时间点
        'mouse2': [120.0, 240.0, 360.0, 480.0, 600.0],  # 慢刺激触发时间点
        'mouse3': [120.0, 240.0, 360.0, 480.0, 600.0]  # 慢刺激触发时间点
    },
    'beard_fast': {
        'type': 'defined_in_config', # 显式声明这是在config里定义的
        'mouse1': [60.0, 180.0, 300.0, 420.0, 540.0],  # 快刺激触发时间点
        'mouse2': [180.0, 300.0, 420.0],  # 快刺激触发时间点
        'mouse3': [120.0, 240.0, 360.0, 480.0, 600.0]  # 快刺激触发时间点
    }
}

# MNE事件ID映射 (用于区分不同事件)
EVENT_IDS = {
    'visual': 1,
    'beard_slow': 2,
    'beard_fast': 3
}

# ===================================================================
# 6. 脑区映射设置 (Brain Region Mapping)
# ===================================================================

# 左右半球的脑区通道映射
REGION_MAP = {
    'Left': {
        'M2': [14, 0, 4, 15],
        'M1': [8, 7, 3, 1],
        'S1': [12, 6, 2, 5],
        'V1': [10, 11],
        'V2': [9, 13]
    },
    'Right': {
        'M2': [17, 31, 27, 16],
        'M1': [23, 24, 28, 30],
        'S1': [25, 19, 29, 26],
        'V1': [20, 21],
        'V2': [18, 22]
    }
}

# 脑区颜色设置 (用于绘图)
REGION_COLORS = {
    'M2': 'blue',
    'M1': 'green',
    'S1': 'red',
    'V1': 'purple',
    'V2': 'orange'
}

# ===================================================================
# 7. 绘图通用设置 (General Plotting Settings)
# ===================================================================

# 目标数据设置 (可在脚本中覆盖)
TARGET_SUBJECT = 'mouse1'    # 目标被试
TARGET_PARADIGM = 'visual'   # 目标范式
TARGET_TRIAL = 1             # 目标试次

# 通用时间窗口设置 (可在脚本中覆盖)
PLOT_T_MIN = 20.0  # 默认绘图起始时间 (秒)
PLOT_T_MAX = 25.0  # 默认绘图结束时间 (秒)

# ===================================================================
# 8. 原始轨迹图设置 (Raw Trace Plotting Settings)
# ===================================================================

# 振幅缩放因子 (用于将数据转换为微伏)
SCALE_AMPLITUDE = 1e-6 / 1e-6  # 可根据数据单位调整分母

# ===================================================================
# 9. 频谱图设置 (Spectrogram Plotting Settings)
# ===================================================================

# STFT参数
STFT_WINDOW_SIZE = 128  # STFT窗口大小
STFT_TIME_STEP = 64     # STFT时间步长 (通常为窗口大小的一半)

# 频率范围设置
TFR_FMIN = 0.5    # 感兴趣的最低频率 (Hz)
TFR_FMAX = 200.0  # 感兴趣的最高频率 (Hz)
